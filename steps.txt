docker-compose exec web python manage.py startapp accounts

## ADD in config/setting.py ->  INSTALLED_APPS = [ ... 'accounts', ]

## ADD in accounts/models.py -> 
from django.contrib.auth.models import AbstractUser
class CustomUser(AbstractUser):
    pass

add in config/setting.py ->
## accounts config
AUTH_USER_MODEL = 'accounts.CustomUser'

## ADD in config/setting.py -> from environs import Env
pipenv install environs
pipenv requirements > requirements.txt
docker-compose up
git rm .env --cached


## CREATE in accounts/ -> forms.py 

## ADD these in accounts/forms.py
from django.contrib.auth.forms import UserCreationForm, UserChangeForm
from django.contrib.auth import get_user_model
class CustomUserCreationForm(UserCreationForm):
    class Meta:
        model = get_user_model()
        fields = ('email', 'username',)
class CustomUserChangeForm(UserChangeForm):
    class Meta:
        model = get_user_model()
        fields = ('email', 'username',)


## ADD these in accounts/admin.py
from django.contrib import admin
from django.contrib.auth.admin import UserAdmin
from .models import CustomUser
from .forms import CustomUserCreationForm, CustomUserChangeForm
@admin.register(CustomUser)
class CustomUserAdmin(UserAdmin):
    model = CustomUser
    add_form = CustomUserCreationForm
    form = CustomUserChangeForm
    list_display = ('email', 'username')
# @admin.register(CustomUser)
# Instead of :
# admin.site.register(CustomUser, CustomUserAdmin)


docker-compose exec web python manage.py makemigrations
docker-compose exec web python manage.py migrate


sudo apt install certbot
sudo certbot certonly --standalone -d sina.sinalalehbakhsh.monster

sudo cp /etc/letsencrypt/live/sina.sinalalehbakhsh.monster/fullchain.pem /home/django/OnlineShope
sudo cp /etc/letsencrypt/live/sina.sinalalehbakhsh.monster/privkey.pem /home/django/OnlineShope


## Additional Tips
## Automate certificate renewal: 
## Certificates from Let's Encrypt expire every 90 days. 
## Set up a cron job to renew the certificates and reload the Nginx configuration.
sudo crontab -e

## Add the following line to the cron file:
0 3 * * * certbot renew --post-hook "docker exec <NGINX_CONTAINER_NAME> nginx -s reload"




